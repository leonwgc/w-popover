import t,{useRef as e,useEffect as n,useLayoutEffect as r,useState as o,useImperativeHandle as i,useCallback as c,useMemo as l}from"react";import u from"react-dom";function a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function f(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach((function(e){d(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function s(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}function p(t){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p(t)}function d(t,e,n){return(e=s(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function m(){return m=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},m.apply(this,arguments)}function v(t,e){if(null==t)return{};var n,r,o=function(t,e){if(null==t)return{};var n,r,o={},i=Object.keys(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||(o[n]=t[n]);return o}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}function y(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,c,l=[],u=!0,a=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);u=!0);}catch(t){a=!0,o=t}finally{try{if(!u&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(a)throw o}}return l}}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return g(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var b=t.createElement("svg",m({viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},{width:"1em",height:"1em",fill:"currentColor"}),t.createElement("path",{d:"M240.512 180.181333l271.530667 271.488 271.530666-271.488a42.666667 42.666667 0 0 1 56.32-3.541333l4.010667 3.541333a42.666667 42.666667 0 0 1 0 60.330667l-271.530667 271.530667 271.530667 271.530666a42.666667 42.666667 0 0 1-56.32 63.872l-4.010667-3.541333-271.530666-271.530667-271.530667 271.530667-4.010667 3.541333a42.666667 42.666667 0 0 1-56.32-63.872l271.488-271.530666-271.488-271.530667a42.666667 42.666667 0 0 1 60.330667-60.330667z","p-id":"2884"})),h=function(e){return t.createElement("div",e,b)};function w(t){var n=e(t);return n.current=t,n}h.displayName="Close";var O=function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=e(!1);n((function(){if(o.current)return t();o.current=!0}),r)},x=function(t){var e,n=t.current;return n instanceof HTMLElement?e=n:n.current?e=n.current:"function"==typeof n&&(e=n()),e},E=function(t,e,n){if("object"===p(e)&&e)for(var r=0,o=Object.keys(e);r<o.length;r++){var i=o[r];t.style[i]=e[i]}else"string"==typeof e&&(t.classList.add(e),"string"==typeof n&&n&&t.classList.contains(n)&&t.classList.remove(n))},j=!("undefined"==typeof window||!window),C=!1;try{window&&window.addEventListener("test",null,Object.defineProperty({},"passive",{get:function(){C={passive:!0}}}))}catch(t){}var k=j?r:n,S=k;function T(t,r,i,c){var l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:220,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=o(r),f=y(a,2),s=f[0],p=f[1],d=w(t),m=e(0),v=w(i),g=w(c);return S((function(){var t=x(d);r&&t instanceof Element&&(E(t,v.current,g.current),p(!0),m.current=window.setTimeout((function(){E(t,g.current,v.current)}),u))}),[r,s,v,g,d,u]),O((function(){if(!r&&s){var t=x(d);m.current=window.setTimeout((function(){E(t,v.current,g.current),m.current=window.setTimeout((function(){p(!1)}),l)}),u)}}),[r]),n((function(){return function(){m.current&&clearTimeout(m.current)}}),[]),s||r}var P=["children","visible","style","duration","hideOverflow"],N=t.forwardRef((function(r,o){var c=r.children,l=r.visible,u=r.style,a=r.duration,s=void 0===a?220:a,p=r.hideOverflow,d=void 0===p||p,y=v(r,P),g=e(null),b=e("");i(o,(function(){return g.current}));var h=T((function(){return g.current}),l,{opacity:0},{opacity:.5},s);return n((function(){return b.current=document.body.style.overflow,document.body.style.overflow=l&&d?"hidden":b.current,function(){document.body.style.overflow=b.current}}),[l,d]),h?t.createElement("div",m({ref:g},y,{style:f(f({},u),{},{opacity:0,background:"rgba(0, 0, 0)",zIndex:1e3,position:"fixed",left:0,top:0,bottom:0,right:0,width:"100%",touchAction:"none",display:h?"":"none",transition:"opacity ".concat(s,"ms ease-in-out")})}),c):null}));N.displayName="W-Mask";var L={bottom:"top",top:"bottom",left:"right",right:"left"},D=function(t){return L[t]};function M(t,e,r,o){var i=w(r),c=w(e),l=w(t),u=w(o);n((function(){var t=function(t,e){return t?"function"==typeof t?t():t&&"current"in t?t.current:t:e}(l.current,window);if(null==t?void 0:t.addEventListener){var e=function(t){var e;return null===(e=i.current)||void 0===e?void 0:e.call(i,t)},n=c.current,r=u.current;return t.addEventListener(n,e,r),function(){t.removeEventListener(n,e,r)}}}),[])}var I=function(t){if("[object Window]"!==t.toString()){var e=t.ownerDocument;return e&&e.defaultView||window}return t},A=function(t){return function(t){return(R(t)?t.ownerDocument:t.document)||window.document}(t).documentElement},z=function(t){return I(t).getComputedStyle(t)},B=function(t){return t?(t.nodeName||"").toLowerCase():""},F=function(t){return t&&"html"!==B(t)?t.assignedSlot||t.parentNode||A(t):t},R=function(t){return t instanceof I(t).Element||t instanceof Element},H=function(t){return t instanceof I(t).HTMLElement||t instanceof HTMLElement},V=function(t){return["table","td","th"].indexOf(B(t))>=0},W=function(t){return H(t)&&"fixed"!==z(t).position?t.offsetParent:null},_=function(t,e){var n=I(t);null==e||e(t);for(var r=W(t);r&&V(r)&&"static"===z(r).position;)null==e||e(r),r=W(r);return r||function(t,e){null==e||e(t);for(var n=F(t);H(n)&&["html","body"].indexOf(B(n))<0;){null==e||e(n);var r=z(n);if("none"!==r.transform||"none"!==r.perspective||r.willChange&&"auto"!==r.willChange)return n;n=F(n)}return n}(t,e)||n},Y=function(t){var e=0;return _(t,(function(t){e+=t.offsetTop})),e},U=/scroll|auto|overlay/i;function $(t){return"HTML"!==t.tagName&&"BODY"!==t.tagName&&1===t.nodeType}function q(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window,n=t;n&&n!==e&&$(n);){var r=window.getComputedStyle(n),o=r.overflowY;if(U.test(o))return n;n=n.parentNode}return e}var G=["placement","content","arrow","visible","closable","onVisibleChange","onClose","className","style","children","mask","maskStyle","maskClass","closeOnClickOutside","closeOnMaskClick","transition","transitionDuration","transitionTimingFunction","offset"],J=k,K={opacity:0,transform:"scale(0)"},Q={opacity:1,transform:"scale(1)"},X=function(n){var r=n.placement,i=void 0===r?"bottom":r,a=n.content,s=n.arrow,p=void 0===s||s,g=n.visible,b=n.closable,x=n.onVisibleChange,k=n.onClose,S=n.className,P=n.style,L=n.children,I=n.mask,A=n.maskStyle,F=n.maskClass,R=n.closeOnClickOutside,H=void 0===R||R,V=n.closeOnMaskClick,W=void 0===V||V,_=n.transition,U=void 0===_||_,$=n.transitionDuration,X=void 0===$?220:$,Z=n.transitionTimingFunction,tt=void 0===Z?"ease-in-out":Z,et=n.offset,nt=void 0===et?{}:et,rt=v(n,G),ot=e(),it=e(null),ct=w(nt),lt=w(k),ut=y(o({}),2),at=ut[0],ft=ut[1],st=e(!1),pt=t.useCallback((function(t,e){var n=it.current;E(n,{transitionProperty:"none",transform:"none"});var r=function(t,e,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"bottom",i=arguments.length>5?arguments[5]:void 0,c=t.getBoundingClientRect(),l=e.getBoundingClientRect(),u=n.getBoundingClientRect(),a="body"===B(n),f=z(e).position,s="fixed"===f,p=r instanceof Element?r.scrollTop:r.pageYOffset,d="fixed"===f||r instanceof Element,m=d?l.top:a?l.top+p:Y(e),v=m,y=l.height+m,g=l.left-(d?0:u.left),b=l.width,h=l.height,w={top:{top:v-c.height-12,left:g+b/2-c.width/2},bottom:{top:y+12,left:g+b/2-c.width/2},left:{top:v+h/2-c.height/2,left:g-c.width-12},right:{top:v+h/2-c.height/2,left:g+b+12},"top-right":{top:v-c.height-12,left:g+b-c.width},"top-left":{top:v-c.height-12,left:g},"bottom-right":{top:y+12,left:g+b-c.width},"bottom-left":{top:y+12,left:g},"right-top":{top:v,left:g+b+12},"left-top":{top:v,left:g-c.width-12},"right-bottom":{top:y-c.height,left:g+b+12},"left-bottom":{top:y-c.height,left:g-c.width-12}},O={x:i.x||0,y:i.y||0},x=w[o];return{position:s?"fixed":"absolute",top:x.top+O.y,left:x.left+O.x}}(n,t,document.body,e,i,ct.current),o=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"bottom",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:12,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:6,o=t.getBoundingClientRect(),i=y(e.split("-"),2),c=i[0],l=i[1],u=d({boxShadow:{top:"1px 1px 1px 0px rgba(0, 0, 0, 0.05)",right:"-1px 1px 1px 0px rgba(0, 0, 0, 0.05)",bottom:"-1px -1px 1px 0px rgba(0, 0, 0, 0.05)",left:"1px -1px 1px 0px rgba(0, 0, 0, 0.05)"}[c]},D(c),-r/2);if(l)return f(d({},l,2*n),u);var a={};return["bottom","top"].includes(c)&&(a.right=(o.width-r)/2),["left","right"].includes(c)&&(a.top=(o.height-r)/2),f(f({},a),u)}(n,i,12);E(n,{top:r.top+"px",left:r.left+"px",position:r.position}),U&&!st.current&&(st.current=!0,E(n,K),n.scrollTop,E(n,{transitionProperty:"transform, opacity"})),ft(o)}),[U,i,ct]),dt=function(){var t=ot.current,e=q(t);pt(t,e)},mt=c((function(t){var e,n=it.current,r=ot.current;!n||n.contains(t.target)||r.contains(t.target)||(null===(e=lt.current)||void 0===e||e.call(lt))}),[lt]);M((function(){return window}),"resize",g?dt:void 0,C),M((function(){return q(ot.current)}),"scroll",g?dt:void 0,C),M((function(){return document}),"click",H?mt:void 0),J((function(){var t=ot.current,e=q(t);g&&pt(t,e)}),[pt,g]);var vt=l((function(){return function(t){var e=t.split("-"),n="";return e[0]&&(n+=D(e[0])),e[1]&&(n+=" "+e[1]),n}(i)}),[i]),yt=T((function(){return U?it.current:null}),g,K,Q,X);return O((function(){null==x||x(g),g||(st.current=!1)}),[g]),t.createElement(t.Fragment,null,t.createElement(N,{visible:I&&g,className:F,style:A,duration:X,onClick:function(){W&&(null==k||k())}}),t.cloneElement(L,{ref:ot}),j&&u.createPortal(t.createElement(t.Fragment,null,(U&&yt||!U&&g)&&t.createElement("div",m({},rt,{ref:it,className:"w-popover ".concat(S||""),style:f({position:"absolute",background:"#fff",zIndex:1e3,transformOrigin:vt,transitionTimingFunction:tt,transitionDuration:"".concat(X,"ms"),willChange:U?"transform, opacity":"unset"},P)}),p&&t.createElement("div",{className:"w-popover__arrow",style:f({position:"absolute",width:6,height:6,zIndex:-1,background:"inherit",transform:"rotate(45deg)"},at)}),b&&t.createElement(h,{className:"w-popover__close",onClick:k,style:{position:"absolute",zIndex:10,top:6,right:6,cursor:"pointer",color:"rgb(0,0,0)",opacity:.35,display:"flex",alignItems:"center",justifyContent:"center"}}),a)),document.body))};X.displayName="W-Popover";var Z=["hoverDelay","placement","arrow","offset","className","style","children"],tt=function(n){var r=n.hoverDelay,i=void 0===r?100:r,c=n.placement,l=void 0===c?"top":c,u=n.arrow,a=void 0===u||u,s=n.offset,p=n.className,d=n.style,g=n.children,b=v(n,Z),h=e(0),w=y(o(!1),2),O=w[0],x=w[1],E={onMouseEnter:function(){h.current&&clearTimeout(h.current),x(!0)},onMouseLeave:function(){h.current=window.setTimeout((function(){x(!1)}),i)},onFocus:function(){h.current&&clearTimeout(h.current),x(!0)}};return t.createElement(X,m({},b,{className:"w-tooltip ".concat(p),style:f({background:"#333",color:"#fff",padding:"6px 12px"},d),visible:O,arrow:a,placement:l,offset:s},E),t.isValidElement(g)?t.cloneElement(g,f({},E)):t.createElement("span",E,g))};tt.displayName="W-Tooltip";export default X;export{X as Popover,tt as Tooltip};
