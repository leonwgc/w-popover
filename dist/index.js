"use strict";var t=require("react"),e=require("react-dom"),n=require("@react-spring/web");function r(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var o=r(t),i=r(e);function a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function l(t){for(var e=1;arguments.length>e;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach((function(e){u(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function c(){return c=Object.assign||function(t){for(var e=1;arguments.length>e;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},c.apply(this,arguments)}function f(t,e){if(null==t)return{};var n,r,o=function(t,e){if(null==t)return{};var n,r,o={},i=Object.keys(t);for(r=0;i.length>r;r++)0>e.indexOf(n=i[r])&&(o[n]=t[n]);return o}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;i.length>r;r++)0>e.indexOf(n=i[r])&&Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}function s(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==n)return;var r,o,i=[],a=!0,l=!1;try{for(n=n.call(t);!(a=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);a=!0);}catch(t){l=!0,o=t}finally{try{a||null==n.return||n.return()}finally{if(l)throw o}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return d(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);e>n;n++)r[n]=t[n];return r}var p=function(t){if(""+t!="[object Window]"){var e=t.ownerDocument;return e&&e.defaultView||window}return t},m=function(t){return function(t){return(b(t)?t.ownerDocument:t.document)||window.document}(t).documentElement},h=function(t){return p(t).getComputedStyle(t)},v=function(t){return t?(t.nodeName||"").toLowerCase():""},g=function(t){return t&&"html"!==v(t)?t.assignedSlot||t.parentNode||m(t):t},b=function(t){return t instanceof p(t).Element||t instanceof Element},y=function(t){return t instanceof p(t).HTMLElement||t instanceof HTMLElement},w=function(t){return["table","td","th"].indexOf(v(t))>=0},x=function(t){return y(t)&&"fixed"!==h(t).position?t.offsetParent:null},O=function(t,e){var n=p(t);null==e||e(t);for(var r=x(t);r&&w(r)&&"static"===h(r).position;)null==e||e(r),r=x(r);return r||function(t,e){null==e||e(t);for(var n=g(t);y(n)&&0>["html","body"].indexOf(v(n));){null==e||e(n);var r=h(n);if("none"!==r.transform||"none"!==r.perspective||r.willChange&&"auto"!==r.willChange)return n;n=g(n)}return n}(t,e)||n},E=function(t){var e=0;return O(t,(function(t){e+=t.offsetTop})),e},C=function(t){return{bottom:"top",top:"bottom",left:"right",right:"left"}[t]};function j(t){var e,n,r="";if("string"==typeof t||"number"==typeof t)r+=t;else if("object"==typeof t)if(Array.isArray(t))for(e=0;t.length>e;e++)t[e]&&(n=j(t[e]))&&(r&&(r+=" "),r+=n);else for(e in t)t[e]&&(r&&(r+=" "),r+=e);return r}function k(){for(var t,e,n=0,r="";arguments.length>n;)(t=arguments[n++])&&(e=j(t))&&(r&&(r+=" "),r+=e);return r}function S(t,e){void 0===e&&(e={});var n=e.insertAt;if(t&&"undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css","top"===n&&r.firstChild?r.insertBefore(o,r.firstChild):r.appendChild(o),o.styleSheet?o.styleSheet.cssText=t:o.appendChild(document.createTextNode(t))}}S(".uc-mask {\n  background-color: rgba(0, 0, 0);\n  z-index: 100;\n  position: fixed;\n  left: 0;\n  top: 0;\n  bottom: 0;\n  right: 0;\n  width: 100%;\n  touch-action: none;\n}\n");var N=["children","className","visible","duration","style","hideOverflow"],P=o.default.forwardRef((function(e,r){var i,a=e.children,u=e.className,d=e.visible,p=e.duration,m=void 0===p?280:p,h=e.style,v=e.hideOverflow,g=void 0===v||v,b=f(e,N),y=s(t.useState(d),2),w=y[0],x=y[1],O=n.useSpring({opacity:d?.45:0,onStart:function(){x(!0)},onRest:function(){},config:{duration:m}});return t.useEffect((function(){document.body.style.overflow=d&&g?"hidden":""}),[d,g]),i=function(){document.body.style.overflow=""},t.useLayoutEffect((function(){return function(){null==i||i()}}),[]),w||d?o.default.createElement(n.animated.div,c({ref:r},b,{className:k("uc-mask",u),style:l(l({},O),h)}),a):null}));P.displayName="UC-Mask";var R=o.default.createElement("svg",c({viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},{width:"1em",height:"1em",fill:"currentColor"}),o.default.createElement("path",{d:"M240.512 180.181333l271.530667 271.488 271.530666-271.488a42.666667 42.666667 0 0 1 56.32-3.541333l4.010667 3.541333a42.666667 42.666667 0 0 1 0 60.330667l-271.530667 271.530667 271.530667 271.530666a42.666667 42.666667 0 0 1-56.32 63.872l-4.010667-3.541333-271.530666-271.530667-271.530667 271.530667-4.010667 3.541333a42.666667 42.666667 0 0 1-56.32-63.872l271.488-271.530666-271.488-271.530667a42.666667 42.666667 0 0 1 60.330667-60.330667z","p-id":"2884"})),A=function(t){return o.default.createElement("span",t,R)};A.displayName="Close";S(".uc-popover {\n  position: absolute;\n  z-index: 1000;\n  background: #fff;\n  border-radius: 2px;\n  box-shadow: 0 2px 12px 0 rgba(0, 0, 0, 0.1);\n}\n.uc-popover .uc-popover-close {\n  position: absolute;\n  z-index: 10;\n  top: 6px;\n  right: 6px;\n  cursor: pointer;\n  color: #000;\n  opacity: 0.35;\n  font-size: 14px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n.uc-popover .uc-popover-close :hover {\n  opacity: 0.75;\n}\n.uc-popover .uc-popover-arrow {\n  position: absolute;\n  width: 6px;\n  height: 6px;\n  z-index: -1;\n  background: inherit;\n  transform: rotate(45deg);\n}\n");var M=["left","top","anchor","placement","style"],z=function(){},B=z,L=function(t){return"[object Number]"===Object.prototype.toString.call(t)&&t==t},T=["placement","content","arrow","visible","closable","onVisibleChange","onClose","className","style","children","mask","maskStyle","maskClass","mountContainer","closeOnClickOutside","closeOnMaskClick","animate","offset"],D=function(t,e){var n=t;for(var r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);return n}((function(e){var r,a,d=e.placement,p=void 0===d?"bottom":d,b=e.content,w=e.arrow,x=void 0===w||w,O=e.visible,j=e.closable,S=e.onVisibleChange,N=e.onClose,R=e.className,M=e.style,z=e.children,B=e.mask,L=e.maskStyle,D=e.maskClass,q=e.mountContainer,I=e.closeOnClickOutside,H=void 0===I||I,F=e.closeOnMaskClick,V=void 0===F||F,U=e.animate,Y=void 0===U||U,Q=e.offset,W=void 0===Q?{}:Q,$=f(e,T),G=t.useRef(),J=t.useRef(null),K=t.useRef(0),X=t.useRef(W),Z=(a=t.useRef(r=N),t.useEffect((function(){a.current=r}),[r]),a),_=s(t.useState({}),2),tt=_[0],et=_[1],nt=s(t.useState({}),2),rt=nt[0],ot=nt[1],it=s(t.useState(O),2),at=it[0],lt=it[1],ut=(null==q?void 0:q())||document.body;t.useEffect((function(){X.current=W}),[W]),function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=t.useRef(!1);t.useEffect((function(){if(r.current)return e();r.current=!0}),n)}((function(){null==S||S(O)}),[O]),t.useEffect((function(){var t=G.current,e=function(t,e){for(var n=g(t);y(n)&&0>["html","body"].indexOf(v(n));){var r=h(n).overflowY,o="visible"!==r&&"hidden"!==r;if(null==e||e(n),o&&n.scrollHeight>n.clientHeight)return n;n=n.parentNode}return m(t)}(t),n=function(t,e){var n=J.current,r=function(t,e,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"bottom",i=arguments.length>5?arguments[5]:void 0,a=t.getBoundingClientRect(),l=e.getBoundingClientRect(),u=n.getBoundingClientRect(),c="body"===v(n),f="fixed"===h(e).position,s=f?l.top:c?l.top+window.pageYOffset:E(e),d=l.height+s,p=l.left-(f?0:u.left),m=l.width,g=l.height,b={x:i.x||0,y:i.y||0},y={top:{top:s-a.height-12,left:p+m/2-a.width/2},bottom:{top:d+12,left:p+m/2-a.width/2},left:{top:s+g/2-a.height/2,left:p-a.width-12},right:{top:s+g/2-a.height/2,left:p+m+12},"top-right":{top:s-a.height-12,left:p+m-a.width},"top-left":{top:s-a.height-12,left:p},"bottom-right":{top:d+12,left:p+m-a.width},"bottom-left":{top:d+12,left:p},"right-top":{top:s,left:p+m+12},"left-top":{top:s,left:p-a.width-12},"right-bottom":{top:d-a.height,left:p+m+12},"left-bottom":{top:d-a.height,left:p-a.width-12}}[o];return{position:f?"fixed":"absolute",top:Math.max(y.top+b.y,0),left:Math.max(y.left+b.x,0)}}(n,t,document.body,e,p,X.current),o=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"bottom",n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:12,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6,i=t.getBoundingClientRect(),a=s(e.split("-"),2),c=a[0],f=a[1],d={top:"1px 1px 1px 0px rgba(0, 0, 0, 0.05)",right:"-1px 1px 1px 0px rgba(0, 0, 0, 0.05)",bottom:"-1px -1px 1px 0px rgba(0, 0, 0, 0.05)",left:"1px -1px 1px 0px rgba(0, 0, 0, 0.05)"},p=u({boxShadow:n?"none":d[c]},C(c),-o/2);if(f)return l(u({},f,2*r),p);var m={};return["bottom","top"].includes(c)&&(m.right=(i.width-o)/2),["left","right"].includes(c)&&(m.top=(i.height-o)/2),l(l({},m),p)}(n,p,B,12);et(r),ot(o)},r=function(){K.current&&window.cancelAnimationFrame(K.current),K.current=window.requestAnimationFrame((function(){n(t,e)}))};if(O)return n(t,e),window.addEventListener("resize",r),function(){window.removeEventListener("resize",r)}}),[O,p,B]);var ct=t.useCallback((function(t){var e,n=J.current,r=G.current;!n||n.contains(t.target)||r.contains(t.target)||(null===(e=Z.current)||void 0===e||e.call(Z))}),[Z]);t.useEffect((function(){if(H)return window.addEventListener("click",ct,!1),function(){window.removeEventListener("click",ct,!1)}}),[H,ct]);var ft=n.useSpring({translate:O?0:10,opacity:O?1:0,onStart:function(){lt(!0)},onRest:function(){lt(O)},immediate:!Y,config:{duration:220,easing:n.easings.easeInOutQuart}}),st=ft.translate,dt=ft.opacity;return o.default.createElement(o.default.Fragment,null,o.default.cloneElement(z,{ref:G}),i.default.createPortal((O||at)&&o.default.createElement("div",{className:k("uc-popover-wrap")},o.default.createElement(P,{visible:B&&O,className:D,style:L,onClick:function(){V&&(null==N||N())}}),o.default.createElement(n.animated.div,c({},$,{ref:J,className:k(R,"uc-popover",{mask:B}),style:l(l(l({},tt),M),{},{opacity:dt,transform:st.to((function(t){var e=p.split("-")[0];return"bottom"===e?"translate(0, -".concat(t,"%)"):"top"===e?"translate(0, ".concat(t,"%)"):"left"===e?"translate(".concat(t,"%, 0)"):"right"===e?"translate(-".concat(t,"%, 0)"):"none"}))})}),x&&o.default.createElement("span",{className:k("uc-popover-arrow"),style:rt}),j&&o.default.createElement(A,{className:k("uc-popover-close"),onClick:N}),o.default.createElement("div",{className:k("uc-popover-content")},b))),ut))}),{show:function(t){var e,n=t.left,r=t.top,a=t.anchor,u=t.placement,s=void 0===u?"top":u,d=t.style,p=f(t,M),m=document.createElement("div");B&&(null===(e=B)||void 0===e||e());var h=0,v=0;if(!L(n)||!L(r)){if(!a)throw Error("no anchor / left,top");if("string"==typeof a?a=document.querySelector(a):"current"in a&&(a=a.current),!(a instanceof Element))throw Error("no anchor found");var g=a.getBoundingClientRect();n=g.left,r=g.top,h=g.width,v=g.height}var b=function(t,e){var n=e||document.createElement("div");document.body.appendChild(n),i.default.render(t,n);var r=function(){i.default.unmountComponentAtNode(n),n&&n.parentNode&&n.parentNode.removeChild(n)};return function(t){"function"==typeof t?t().then(r):r()}}(o.default.createElement(D,c({closeOnClickOutside:!1,onClose:function(){return b()},visible:!0,style:l({padding:20},d),placement:s},p),o.default.createElement("span",{style:{position:"fixed",left:n,top:r,width:h,height:v,visibility:"hidden",pointerEvents:"none"},className:"uc-popover-anchor"})),m);return B=b,b},hide:B||z});module.exports=D;
