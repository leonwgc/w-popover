"use strict";var t=require("react"),e=require("react-dom");function n(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var r=n(t),o=n(e);function i(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function u(t){for(var e=1;arguments.length>e;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?i(Object(n),!0).forEach((function(e){c(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function c(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a(){return a=Object.assign||function(t){for(var e=1;arguments.length>e;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},a.apply(this,arguments)}function f(t,e){if(null==t)return{};var n,r,o=function(t,e){if(null==t)return{};var n,r,o={},i=Object.keys(t);for(r=0;i.length>r;r++)0>e.indexOf(n=i[r])&&(o[n]=t[n]);return o}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;i.length>r;r++)0>e.indexOf(n=i[r])&&Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}function s(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==n)return;var r,o,i=[],u=!0,l=!1;try{for(n=n.call(t);!(u=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);u=!0);}catch(t){l=!0,o=t}finally{try{u||null==n.return||n.return()}finally{if(l)throw o}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return d(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);e>n;n++)r[n]=t[n];return r}function p(t){var e,n,r="";if("string"==typeof t||"number"==typeof t)r+=t;else if("object"==typeof t)if(Array.isArray(t))for(e=0;t.length>e;e++)t[e]&&(n=p(t[e]))&&(r&&(r+=" "),r+=n);else for(e in t)t[e]&&(r&&(r+=" "),r+=e);return r}function m(){for(var t,e,n=0,r="";arguments.length>n;)(t=arguments[n++])&&(e=p(t))&&(r&&(r+=" "),r+=e);return r}var v=r.default.createElement("svg",a({viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},{width:"1em",height:"1em",fill:"currentColor"}),r.default.createElement("path",{d:"M240.512 180.181333l271.530667 271.488 271.530666-271.488a42.666667 42.666667 0 0 1 56.32-3.541333l4.010667 3.541333a42.666667 42.666667 0 0 1 0 60.330667l-271.530667 271.530667 271.530667 271.530666a42.666667 42.666667 0 0 1-56.32 63.872l-4.010667-3.541333-271.530666-271.530667-271.530667 271.530667-4.010667 3.541333a42.666667 42.666667 0 0 1-56.32-63.872l271.488-271.530666-271.488-271.530667a42.666667 42.666667 0 0 1 60.330667-60.330667z","p-id":"2884"})),y=function(t){return r.default.createElement("div",t,v)};function h(e){var n=t.useRef(e);return n.current=e,n}y.displayName="Close";var b=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=t.useRef(!1);t.useEffect((function(){if(r.current)return e();r.current=!0}),n)},g=function(t){var e,n=t.current;return n instanceof Element?e=n:n.current?e=n.current:"function"==typeof n&&(e=n()),e},w=function(t,e,n){if("object"===l(e)&&e)for(var r=0,o=Object.keys(e);o.length>r;r++){var i=o[r];t.style[i]=e[i]}else"string"==typeof e&&(t.classList.add(e),"string"==typeof n&&n&&t.classList.contains(n)&&t.classList.remove(n))};function O(e,n,r,o){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:220,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,l=t.useState(n),c=s(l,2),a=c[0],f=c[1],d=h(e),p=t.useRef(0),m=h(r),v=h(o);return t.useLayoutEffect((function(){var t=g(d);n&&(w(t,m.current,v.current),f(!0),p.current=window.setTimeout((function(){w(t,v.current,m.current)}),u))}),[n,a,m,v,d,u]),b((function(){if(!n&&a){var t=g(d);p.current=window.setTimeout((function(){w(t,m.current,v.current),p.current=window.setTimeout((function(){f(!1)}),i)}),u)}}),[n]),t.useEffect((function(){return function(){p.current&&clearTimeout(p.current)}}),[]),a||n}var x=["children","visible","style","hideOverflow"],E=r.default.forwardRef((function(e,n){var o=e.children,i=e.visible,l=e.style,c=e.hideOverflow,s=void 0===c||c,d=f(e,x),p=t.useRef(null),m=t.useRef("");t.useImperativeHandle(n,(function(){return p.current}));var v=O((function(){return p.current}),i,{opacity:0},{opacity:.5},300);return t.useEffect((function(){return m.current=document.body.style.overflow,document.body.style.overflow=i&&s?"hidden":m.current,function(){document.body.style.overflow=m.current}}),[i,s]),v&&r.default.createElement("div",a({ref:p},d,{style:u(u({},l),{},{opacity:0,background:"rgba(0, 0, 0)",zIndex:1e3,position:"fixed",left:0,top:0,bottom:0,right:0,width:"100%",touchAction:"none",display:v?"":"none",transition:"opacity 200ms linear"})}),o)}));E.displayName="UC-Mask";var C=function(t,e){return t?"function"==typeof t?t():t&&"current"in t?t.current:t:e};function j(e,n,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,i=h(r),u=h(n),l=h(e),c=h(o);t.useEffect((function(){var t=C(l.current,window);if(null==t?void 0:t.addEventListener){var e=function(t){var e;return null===(e=i.current)||void 0===e?void 0:e.call(i,t)},n=u.current,r=c.current;return t.addEventListener(n,e,r),function(){t.removeEventListener(n,e,r)}}}),[])}var k,S=["left","top","anchor","placement","style"],P=function(t){return"[object Number]"===Object.prototype.toString.call(t)&&t==t};var N=function(t){if(""+t!="[object Window]"){var e=t.ownerDocument;return e&&e.defaultView||window}return t},R=function(t){return function(t){return(I(t)?t.ownerDocument:t.document)||window.document}(t).documentElement},A=function(t){return N(t).getComputedStyle(t)},L=function(t){return t?(t.nodeName||"").toLowerCase():""},M=function(t){return t&&"html"!==L(t)?t.assignedSlot||t.parentNode||R(t):t},I=function(t){return t instanceof N(t).Element||t instanceof Element},D=function(t){return t instanceof N(t).HTMLElement||t instanceof HTMLElement},T=function(t){return["table","td","th"].indexOf(L(t))>=0},z=function(t){return D(t)&&"fixed"!==A(t).position?t.offsetParent:null},B=function(t,e){var n=N(t);null==e||e(t);for(var r=z(t);r&&T(r)&&"static"===A(r).position;)null==e||e(r),r=z(r);return r||function(t,e){null==e||e(t);for(var n=M(t);D(n)&&0>["html","body"].indexOf(L(n));){null==e||e(n);var r=A(n);if("none"!==r.transform||"none"!==r.perspective||r.willChange&&"auto"!==r.willChange)return n;n=M(n)}return n}(t,e)||n},H=function(t){var e=0;return B(t,(function(t){e+=t.offsetTop})),e},q=function(t,e){for(var n=M(t);D(n)&&0>["html","body"].indexOf(L(n));){var r=A(n).overflowY,o="visible"!==r&&"hidden"!==r;if(null==e||e(n),o&&n.scrollHeight>n.clientHeight)return n;n=n.parentNode}return R(t)},F=function(t,e,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"bottom",i=arguments.length>5?arguments[5]:void 0,u=t.getBoundingClientRect(),l=e.getBoundingClientRect(),c=n.getBoundingClientRect(),a="body"===L(n),f="fixed"===A(e).position,s=f?l.top:a?l.top+window.pageYOffset:H(e),d=s,p=l.height+s,m=l.left-(f?0:c.left),v=l.width,y=l.height,h={top:{top:d-u.height-12,left:m+v/2-u.width/2},bottom:{top:p+12,left:m+v/2-u.width/2},left:{top:d+y/2-u.height/2,left:m-u.width-12},right:{top:d+y/2-u.height/2,left:m+v+12},"top-right":{top:d-u.height-12,left:m+v-u.width},"top-left":{top:d-u.height-12,left:m},"bottom-right":{top:p+12,left:m+v-u.width},"bottom-left":{top:p+12,left:m},"right-top":{top:d,left:m+v+12},"left-top":{top:d,left:m-u.width-12},"right-bottom":{top:p-u.height,left:m+v+12},"left-bottom":{top:p-u.height,left:m-u.width-12}},b={x:i.x||0,y:i.y||0},g=h[o];return{position:f?"fixed":"absolute",top:Math.max(g.top+b.y,0),left:Math.max(g.left+b.x,0)}},_=function(t){return{bottom:"top",top:"bottom",left:"right",right:"left"}[t]},V=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"bottom",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:12,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:6,o=t.getBoundingClientRect(),i=e.split("-"),l=s(i,2),a=l[0],f=l[1],d={top:"1px 1px 1px 0px rgba(0, 0, 0, 0.05)",right:"-1px 1px 1px 0px rgba(0, 0, 0, 0.05)",bottom:"-1px -1px 1px 0px rgba(0, 0, 0, 0.05)",left:"1px -1px 1px 0px rgba(0, 0, 0, 0.05)"},p=c({boxShadow:d[a]},_(a),-r/2);if(f)return u(c({},f,2*n),p);var m={};return["bottom","top"].includes(a)&&(m.right=(o.width-r)/2),["left","right"].includes(a)&&(m.top=(o.height-r)/2),u(u({},m),p)},U=["placement","content","arrow","visible","closable","onVisibleChange","onClose","className","style","children","mask","maskStyle","maskClass","mountContainer","closeOnClickOutside","closeOnMaskClick","transition","transitionDuration","offset"],Y=function(t){var e;return t instanceof HTMLElement?e=t:"[object Object]"===Object.prototype.toString.call(t)&&"current"in t?e=t.current:"function"==typeof t&&(e=null==t?void 0:t()),e},W={top:"bottom",bottom:"top",left:"right",right:"left"},$=function(t,e){var n=t;for(var r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);return n}((function(e){var n=e.placement,i=void 0===n?"bottom":n,l=e.content,c=e.arrow,d=void 0===c||c,p=e.visible,v=e.closable,g=e.onVisibleChange,w=e.onClose,x=e.className,C=e.style,k=e.children,S=e.mask,P=e.maskStyle,N=e.maskClass,R=e.mountContainer,A=void 0===R?document.body:R,L=e.closeOnClickOutside,M=void 0===L||L,I=e.closeOnMaskClick,D=void 0===I||I,T=e.transition,z=void 0===T||T,B=e.transitionDuration,H=void 0===B?200:B,_=e.offset,$=void 0===_?{}:_,G=f(e,U),J=t.useRef(),K=t.useRef(null),Q=t.useRef(0),X=t.useRef($),Z=h(w),tt=s(t.useState({}),2),et=tt[0],nt=tt[1],rt=Y(A),ot=t.useRef(!1);t.useEffect((function(){X.current=$}),[$]),b((function(){null==g||g(p)}),[p]);var it=r.default.useCallback((function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=K.current,o=F(r,t,document.body,e,i,X.current),u=V(r,i,12);r.style.transitionProperty="none",r.style.top=o.top+"px",r.style.left=o.left+"px",r.style.position=o.position,z&&n&&(r.style.visibility="hidden",r.style.opacity="0",r.style.transform="scale(0)",r.style.transitionProperty="transform, opacity",r.style.visibility="visible"),nt(u)}),[z,i]),ut=function(){var t=J.current,e=q(t);it(t,e),Q.current&&window.cancelAnimationFrame(Q.current),Q.current=window.requestAnimationFrame((function(){it(t,e)}))};j((function(){return window}),"resize",p?ut:null),j((function(){return window}),"scroll",p?ut:null),t.useLayoutEffect((function(){var t=J.current,e=q(t);p?(it(t,e,!ot.current),ot.current=!0):ot.current=!1}),[p,it]),j((function(){return window}),"resize");var lt=t.useCallback((function(t){var e,n=K.current,r=J.current;!n||n.contains(t.target)||r.contains(t.target)||(null===(e=Z.current)||void 0===e||e.call(Z))}),[Z]);j((function(){return document}),"click",M?lt:null);var ct=t.useMemo((function(){return function(t){var e=t.split("-"),n="";return e[0]&&(n+=W[e[0]]),e[1]&&(n+=" "+e[1]),n}(i)}),[i]),at=O((function(){return K.current}),p,{opacity:0,transform:"scale(0)"},{opacity:1,transform:"scale(1)"},H);return r.default.createElement(r.default.Fragment,null,r.default.createElement(E,{visible:S&&p,className:N,style:P,onClick:function(){D&&(null==w||w())}}),r.default.cloneElement(k,{ref:J}),o.default.createPortal(r.default.createElement(r.default.Fragment,null,at&&r.default.createElement("div",a({},G,{ref:K,className:m(x,"w-popover"),style:u({position:"absolute",background:"#fff",zIndex:1e3,transformOrigin:ct,transitionDuration:"".concat(H,"ms"),transitionProperty:"none",willChange:"transform, opacity"},C)}),d&&r.default.createElement("div",{className:m("w-popover__arrow"),style:u({position:"absolute",width:6,height:6,zIndex:-1,background:"inherit",transform:"rotate(45deg)"},et)}),v&&r.default.createElement(y,{className:m("w-popover__close"),onClick:w,style:{position:"absolute",zIndex:10,top:6,right:6,cursor:"pointer",color:"rgb(0,0,0)",opacity:.35,display:"flex",alignItems:"center",justifyContent:"center"}}),l)),rt))}),{show:function(t){var e,n=t.left,i=t.top,u=t.anchor,l=t.placement,c=void 0===l?"top":l,s=t.style,d=f(t,S),p=document.createElement("div");k&&(null===(e=k)||void 0===e||e());var m=0,v=0;if(!P(n)||!P(i)){if(!u)throw Error("no anchor / left,top");if("string"==typeof u?u=document.querySelector(u):"current"in u&&(u=u.current),!(u instanceof Element))throw Error("no anchor found");var y=u.getBoundingClientRect();n=y.left,i=y.top,m=y.width,v=y.height}var h=function(t,e){var n=e||document.createElement("div");document.body.appendChild(n),o.default.render(t,n);var r=function(){o.default.unmountComponentAtNode(n),n&&n.parentNode&&n.parentNode.removeChild(n)};return function(t){"function"==typeof t?t().then(r):r()}}(r.default.createElement($,a({closeOnClickOutside:!1,onClose:function(){return h()},visible:!0,transition:!1,style:s,placement:c},d),r.default.createElement("span",{style:{position:"fixed",left:n,top:i,width:m,height:v,visibility:"hidden",pointerEvents:"none"},className:"uc-popover-anchor"})),p);return k=h,h},hide:function(){"function"==typeof k&&k()}});module.exports=$;
